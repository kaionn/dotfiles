# Aerospace 設定ファイル
# ドキュメント: https://nikitabobko.github.io/AeroSpace/guide

# ログイン時に自動起動
start-at-login = true

# JankyBorders の起動（アクティブウィンドウにボーダー表示）
after-startup-command = [
  'exec-and-forget borders active_color=0xffe1e3e4 inactive_color=0xff494d64 width=5.0'
]

# 正規化設定
enable-normalization-flatten-containers = true
enable-normalization-opposite-orientation-for-nested-containers = true

# レイアウト設定
accordion-padding = 30
default-root-container-layout = 'tiles'
default-root-container-orientation = 'auto'

# キーマッピング
key-mapping.preset = 'qwerty'

# Sketchybar との連携
exec-on-workspace-change = ['/bin/bash', '-c', 'sketchybar --trigger aerospace_workspace_change']

# ウィンドウ間のギャップ設定
# outer.top: モニター別に設定
#   - 内蔵ディスプレイ: Notch があるため余白不要 (1px)
#   - 外部ディスプレイ: Sketchybar の高さ(30px) + 余裕 (35px)
[gaps]
inner.horizontal = 10
inner.vertical = 10
outer.left = 1
outer.bottom = 1
outer.top = [{ monitor.built-in = 1 }, 35]
outer.right = 1

# メインモードのキーバインド
# HHKB 向け: ctrl-shift で切替・フォーカス、ctrl-alt で移動
[mode.main.binding]

# レイアウト変更
ctrl-shift-slash = 'layout tiles horizontal vertical'
ctrl-shift-comma = 'layout accordion horizontal vertical'

# ウィンドウ間のフォーカス移動 (ctrl-shift + hjkl)
ctrl-shift-h = 'focus left'
ctrl-shift-j = 'focus down'
ctrl-shift-k = 'focus up'
ctrl-shift-l = 'focus right'

# ウィンドウの移動 (ctrl-alt + hjkl)
ctrl-alt-h = 'move left'
ctrl-alt-j = 'move down'
ctrl-alt-k = 'move up'
ctrl-alt-l = 'move right'

# ウィンドウのリサイズ
ctrl-alt-minus = 'resize smart -50'
ctrl-alt-equal = 'resize smart +50'

# ワークスペースの切り替え (ctrl-shift + アルファベット)
# W: Web, T: Terminal, I: IDE, M: Meeting, C: Communication, A: AI, D: Docs, G: DB/API
ctrl-shift-a = 'workspace A'
ctrl-shift-c = 'workspace C'
ctrl-shift-d = 'workspace D'
ctrl-shift-g = 'workspace G'
ctrl-shift-i = 'workspace I'
ctrl-shift-m = 'workspace M'
ctrl-shift-t = 'workspace T'
ctrl-shift-w = 'workspace W'

# ウィンドウをワークスペースに移動 (ctrl-alt + アルファベット)
ctrl-alt-a = 'move-node-to-workspace A'
ctrl-alt-c = 'move-node-to-workspace C'
ctrl-alt-d = 'move-node-to-workspace D'
ctrl-alt-f = 'fullscreen'
ctrl-alt-g = 'move-node-to-workspace G'
ctrl-alt-i = 'move-node-to-workspace I'
ctrl-alt-m = 'move-node-to-workspace M'
ctrl-alt-t = 'move-node-to-workspace T'
ctrl-alt-w = 'move-node-to-workspace W'

# ワークスペース切り替え
ctrl-shift-tab = 'workspace-back-and-forth'
ctrl-alt-tab = 'move-workspace-to-monitor --wrap-around next'

# サービスモードへの切替
ctrl-alt-semicolon = 'mode service'

# サービスモード
[mode.service.binding]
esc = ['reload-config', 'mode main']
r = ['flatten-workspace-tree', 'mode main']
f = ['layout floating tiling', 'mode main']
backspace = ['close-all-windows-but-current', 'mode main']

alt-shift-h = ['join-with left', 'mode main']
alt-shift-j = ['join-with down', 'mode main']
alt-shift-k = ['join-with up', 'mode main']
alt-shift-l = ['join-with right', 'mode main']

# 特定アプリの設定（フローティング）
[[on-window-detected]]
if.app-id = 'com.apple.finder'
run = 'layout floating'

[[on-window-detected]]
if.app-id = 'com.apple.systempreferences'
run = 'layout floating'

[[on-window-detected]]
if.app-id = 'com.apple.calculator'
run = 'layout floating'

[[on-window-detected]]
if.app-id = 'pl.maketheweb.cleanshotx'
run = 'layout floating'

# ===== アプリ別自動配置 =====

# W: Web Browser
[[on-window-detected]]
if.app-id = 'company.thebrowser.Browser'
run = 'move-node-to-workspace W'

[[on-window-detected]]
if.app-id = 'com.apple.Safari'
run = 'move-node-to-workspace W'

[[on-window-detected]]
if.app-id = 'com.google.Chrome'
run = 'move-node-to-workspace W'

[[on-window-detected]]
if.app-id = 'jp.kiok.nani'
run = 'move-node-to-workspace W'

# T: Terminal
[[on-window-detected]]
if.app-id = 'org.alacritty'
run = 'move-node-to-workspace T'

[[on-window-detected]]
if.app-id = 'com.mitchellh.ghostty'
run = 'move-node-to-workspace T'

[[on-window-detected]]
if.app-id = 'com.googlecode.iterm2'
run = 'move-node-to-workspace T'

# I: IDE
[[on-window-detected]]
if.app-id = 'com.microsoft.VSCode'
run = 'move-node-to-workspace I'

[[on-window-detected]]
if.app-id = 'dev.zed.Zed'
run = 'move-node-to-workspace I'

[[on-window-detected]]
if.app-id = 'com.todesktop.230313mzl4w4u92'
run = 'move-node-to-workspace I'

[[on-window-detected]]
if.app-id = 'com.google.antigravity'
run = 'move-node-to-workspace I'

# C: Communication
[[on-window-detected]]
if.app-id = 'com.tinyspeck.slackmacgap'
run = 'move-node-to-workspace C'

[[on-window-detected]]
if.app-id = 'com.gather.GatherV2'
run = 'move-node-to-workspace C'

[[on-window-detected]]
if.app-id = 'com.hnc.Discord'
run = 'move-node-to-workspace C'

[[on-window-detected]]
if.app-id = 'com.apple.automator.TakeScreenshot'
run = 'move-node-to-workspace C'

# A: AI
[[on-window-detected]]
if.app-id = 'com.anthropic.claudefordesktop'
run = 'move-node-to-workspace A'

# D: Docs
[[on-window-detected]]
if.app-id = 'md.obsidian'
run = 'move-node-to-workspace D'

[[on-window-detected]]
if.app-id = 'com.TickTick.task.mac'
run = 'move-node-to-workspace D'

# G: DB/API Tools
[[on-window-detected]]
if.app-id = 'org.jkiss.dbeaver.core.product'
run = 'move-node-to-workspace G'

[[on-window-detected]]
if.app-id = 'com.postmanlabs.mac'
run = 'move-node-to-workspace G'

# M: Meeting (Zoom, Google Meet, etc.)
[[on-window-detected]]
if.app-id = 'us.zoom.xos'
run = 'move-node-to-workspace M'

[[on-window-detected]]
if.app-id = 'com.google.Chrome.app.kjgfgldnnfoeklkmfkjfagphfepbbdan'
run = 'move-node-to-workspace M'

# モニター割り当て（マルチモニター環境の場合）
[workspace-to-monitor-force-assignment]
W = 'main'
A = 'main'
T = 'main'
I = 'main'
C = 2
M = '27GL850'
